{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"appeal-container\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"loading\"\n};\nconst _hoisted_3 = {\n  key: 1,\n  class: \"error\"\n};\nconst _hoisted_4 = {\n  key: 2,\n  class: \"appeal-form\"\n};\nconst _hoisted_5 = {\n  key: 0\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_upload = _resolveComponent(\"el-upload\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[5] || (_cache[5] = _createElementVNode(\"h2\", null, \"挂号申诉\", -1 /* HOISTED */)), _createCommentVNode(\" 加载状态 \"), $data.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, \"加载中...\")) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 错误提示 \"), $data.error ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, _toDisplayString($data.error), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 申诉表单 \"), !$data.loading && !$data.error ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createVNode(_component_el_form, {\n    model: $data.appealForm,\n    ref: \"appealFormRef\",\n    \"label-width\": \"120px\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_form_item, {\n      label: \"订单号\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_input, {\n        modelValue: $data.appealForm.orderId,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.appealForm.orderId = $event),\n        disabled: \"\"\n      }, null, 8 /* PROPS */, [\"modelValue\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_form_item, {\n      label: \"申诉内容\",\n      prop: \"content\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_input, {\n        type: \"textarea\",\n        modelValue: $data.appealForm.content,\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.appealForm.content = $event),\n        placeholder: \"请输入申诉内容\",\n        rows: \"4\"\n      }, null, 8 /* PROPS */, [\"modelValue\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_form_item, {\n      label: \"附件\",\n      prop: \"attachment\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_upload, {\n        style: {\n          \"display\": \"inline-block\",\n          \"margin-right\": \"10px\"\n        },\n        action: $data.uploadUrl,\n        headers: {\n          token: this.user.token\n        },\n        \"show-file-list\": false,\n        \"on-change\": $options.handleAttachmentChange,\n        \"on-success\": $options.handleFileSuccess\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_button, {\n          size: \"small\",\n          type: \"primary\"\n        }, {\n          default: _withCtx(() => _cache[2] || (_cache[2] = [_createTextVNode(\"点击上传\")])),\n          _: 1 /* STABLE */\n        })]),\n\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"action\", \"headers\", \"on-change\", \"on-success\"]), $data.appealForm.attachment ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5, _toDisplayString($data.appealForm.attachment.name), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_form_item, null, {\n      default: _withCtx(() => [_createVNode(_component_el_button, {\n        type: \"primary\",\n        onClick: $options.submitAppeal\n      }, {\n        default: _withCtx(() => _cache[3] || (_cache[3] = [_createTextVNode(\"提交申诉\")])),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"onClick\"]), _createVNode(_component_el_button, {\n        onClick: $options.handleBack\n      }, {\n        default: _withCtx(() => _cache[4] || (_cache[4] = [_createTextVNode(\"返回\")])),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"onClick\"])]),\n      _: 1 /* STABLE */\n    })]),\n\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"model\"])])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_createCommentVNode","$data","loading","_hoisted_2","error","_hoisted_3","_toDisplayString","_hoisted_4","_createVNode","_component_el_form","model","appealForm","ref","_component_el_form_item","label","_component_el_input","orderId","$event","disabled","prop","type","content","placeholder","rows","_component_el_upload","style","action","uploadUrl","headers","token","user","$options","handleAttachmentChange","handleFileSuccess","_component_el_button","size","_cache","attachment","_hoisted_5","name","onClick","submitAppeal","handleBack"],"sources":["E:\\专业设计项目\\HRS\\HRS-7\\vue\\src\\views\\user\\Appeal.vue"],"sourcesContent":["<template>\r\n  <div class=\"appeal-container\">\r\n    <h2>挂号申诉</h2>\r\n\r\n    <!-- 加载状态 -->\r\n    <div v-if=\"loading\" class=\"loading\">加载中...</div>\r\n\r\n    <!-- 错误提示 -->\r\n    <div v-if=\"error\" class=\"error\">{{ error }}</div>\r\n\r\n    <!-- 申诉表单 -->\r\n    <div v-if=\"!loading &&!error\" class=\"appeal-form\">\r\n      <el-form :model=\"appealForm\" ref=\"appealFormRef\" label-width=\"120px\">\r\n        <el-form-item label=\"订单号\">\r\n          <el-input v-model=\"appealForm.orderId\" disabled></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"申诉内容\" prop=\"content\">\r\n          <el-input type=\"textarea\" v-model=\"appealForm.content\" placeholder=\"请输入申诉内容\" rows=\"4\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"附件\" prop=\"attachment\">\r\n          <el-upload\r\n              style=\"display: inline-block; margin-right: 10px\"\r\n              :action=\"uploadUrl\"\r\n              :headers=\"{ token: this.user.token }\"\r\n              :show-file-list=\"false\"\r\n              :on-change=\"handleAttachmentChange\"\r\n              :on-success=\"handleFileSuccess\"\r\n          >\r\n            <el-button size=\"small\" type=\"primary\">点击上传</el-button>\r\n          </el-upload>\r\n          <span v-if=\"appealForm.attachment\">{{ appealForm.attachment.name }}</span>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"submitAppeal\">提交申诉</el-button>\r\n          <el-button @click=\"handleBack\">返回</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'Appeal',\r\n  data() {\r\n    return {\r\n      appealForm: {\r\n        orderId: this.$route.query.orderId || '',\r\n        content: '',\r\n        attachment: null\r\n      },\r\n      uploadUrl: '',\r\n      loading: false,\r\n      error: '',\r\n      appealFormRef: null,\r\n      user:JSON.parse(localStorage.getItem('xm-user') || '{}')\r\n    };\r\n  },\r\n  created() {\r\n    this.uploadUrl = this.$baseUrl + '/files/add'\r\n  },\r\n  methods: {\r\n    // 处理附件上传变化\r\n    handleAttachmentChange(file) {\r\n      this.appealForm.attachment = file;\r\n    },\r\n    submitAppeal() {\r\n      this.$refs.appealFormRef.validate((valid) => {\r\n        if (valid) {\r\n          this.loading = true;\r\n          this.error = '';\r\n\r\n          // 创建一个 FormData 对象来处理文件上传\r\n          const formData = new FormData();\r\n          formData.append('orderId', this.appealForm.orderId);\r\n          formData.append('content', this.appealForm.content);\r\n          if (this.appealForm.attachment) {\r\n            // 获取文件的原始名字\r\n            const fileName = this.appealForm.attachment.name;\r\n            formData.append('attachment', this.appealForm.attachment);\r\n            // 添加文件原始名字到 FormData\r\n            formData.append('fileName', fileName);\r\n          }\r\n          console.log(formData.get('fileName'));\r\n          this.$request.post('/registration/appeal', formData, {\r\n            headers: {\r\n              'Content-Type': 'multipart/form-data'\r\n            }\r\n          })\r\n              .then(response => {\r\n                this.loading = false;\r\n                if (response.code == 200) {\r\n                  this.$message.success('申诉提交成功');\r\n                  this.handleBack();\r\n                } else {\r\n                  this.$message.error(response.data.message || '申诉提交失败，请稍后重试');\r\n                }\r\n              })\r\n              .catch(error => {\r\n                this.loading = false;\r\n                console.error('申诉提交失败:', error);\r\n                this.$message.error('申诉提交失败，请稍后重试');\r\n              });\r\n        } else {\r\n          this.$message.error('请填写完整的申诉信息');\r\n        }\r\n      });\r\n    },\r\n    handleFileSuccess(response) {\r\n      if (response.code == 200) {\r\n        this.appealForm.attachmentUrl = response.data;\r\n        this.$message.success('文件上传成功');\r\n      } else {\r\n        this.$message.error('文件上传失败');\r\n      }\r\n    },\r\n    // 返回上一页\r\n    handleBack() {\r\n      this.$router.go(-1);\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.appeal-container {\r\n  padding: 20px;\r\n}\r\n\r\n.loading,\r\n.error {\r\n  text-align: center;\r\n  margin-top: 20px;\r\n  font-size: 16px;\r\n  color: #666;\r\n}\r\n\r\n.error {\r\n  color: #f56c6c;\r\n}\r\n\r\n.appeal-form {\r\n  margin-top: 20px;\r\n}\r\n</style>"],"mappings":";;EACOA,KAAK,EAAC;AAAkB;;;EAIPA,KAAK,EAAC;;;;EAGRA,KAAK,EAAC;;;;EAGMA,KAAK,EAAC;;;;;;;;;;;uBAVtCC,mBAAA,CAqCM,OArCNC,UAqCM,G,0BApCJC,mBAAA,CAAa,YAAT,MAAI,sBAERC,mBAAA,UAAa,EACFC,KAAA,CAAAC,OAAO,I,cAAlBL,mBAAA,CAAgD,OAAhDM,UAAgD,EAAZ,QAAM,K,mCAE1CH,mBAAA,UAAa,EACFC,KAAA,CAAAG,KAAK,I,cAAhBP,mBAAA,CAAiD,OAAjDQ,UAAiD,EAAAC,gBAAA,CAAdL,KAAA,CAAAG,KAAK,oB,mCAExCJ,mBAAA,UAAa,E,CACDC,KAAA,CAAAC,OAAO,KAAID,KAAA,CAAAG,KAAK,I,cAA5BP,mBAAA,CA0BM,OA1BNU,UA0BM,GAzBJC,YAAA,CAwBUC,kBAAA;IAxBAC,KAAK,EAAET,KAAA,CAAAU,UAAU;IAAEC,GAAG,EAAC,eAAe;IAAC,aAAW,EAAC;;sBAC3D,MAEe,CAFfJ,YAAA,CAEeK,uBAAA;MAFDC,KAAK,EAAC;IAAK;wBACvB,MAA2D,CAA3DN,YAAA,CAA2DO,mBAAA;oBAAxCd,KAAA,CAAAU,UAAU,CAACK,OAAO;mEAAlBf,KAAA,CAAAU,UAAU,CAACK,OAAO,GAAAC,MAAA;QAAEC,QAAQ,EAAR;;;QAEzCV,YAAA,CAEeK,uBAAA;MAFDC,KAAK,EAAC,MAAM;MAACK,IAAI,EAAC;;wBAC9B,MAAiG,CAAjGX,YAAA,CAAiGO,mBAAA;QAAvFK,IAAI,EAAC,UAAU;oBAAUnB,KAAA,CAAAU,UAAU,CAACU,OAAO;mEAAlBpB,KAAA,CAAAU,UAAU,CAACU,OAAO,GAAAJ,MAAA;QAAEK,WAAW,EAAC,SAAS;QAACC,IAAI,EAAC;;;QAEpFf,YAAA,CAYeK,uBAAA;MAZDC,KAAK,EAAC,IAAI;MAACK,IAAI,EAAC;;wBAC5B,MASY,CATZX,YAAA,CASYgB,oBAAA;QARRC,KAAiD,EAAjD;UAAA;UAAA;QAAA,CAAiD;QAChDC,MAAM,EAAEzB,KAAA,CAAA0B,SAAS;QACjBC,OAAO;UAAAC,KAAA,OAAgBC,IAAI,CAACD;QAAK;QACjC,gBAAc,EAAE,KAAK;QACrB,WAAS,EAAEE,QAAA,CAAAC,sBAAsB;QACjC,YAAU,EAAED,QAAA,CAAAE;;0BAEf,MAAuD,CAAvDzB,YAAA,CAAuD0B,oBAAA;UAA5CC,IAAI,EAAC,OAAO;UAACf,IAAI,EAAC;;4BAAU,MAAIgB,MAAA,QAAAA,MAAA,O,iBAAJ,MAAI,E;;;;;2EAEjCnC,KAAA,CAAAU,UAAU,CAAC0B,UAAU,I,cAAjCxC,mBAAA,CAA0E,QAAAyC,UAAA,EAAAhC,gBAAA,CAApCL,KAAA,CAAAU,UAAU,CAAC0B,UAAU,CAACE,IAAI,oB;;QAElE/B,YAAA,CAGeK,uBAAA;wBAFb,MAAgE,CAAhEL,YAAA,CAAgE0B,oBAAA;QAArDd,IAAI,EAAC,SAAS;QAAEoB,OAAK,EAAET,QAAA,CAAAU;;0BAAc,MAAIL,MAAA,QAAAA,MAAA,O,iBAAJ,MAAI,E;;sCACpD5B,YAAA,CAA6C0B,oBAAA;QAAjCM,OAAK,EAAET,QAAA,CAAAW;MAAU;0BAAE,MAAEN,MAAA,QAAAA,MAAA,O,iBAAF,IAAE,E"},"metadata":{},"sourceType":"module","externalDependencies":[]}