{"ast":null,"code":"import { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"appeal-detail\"\n};\nconst _hoisted_2 = {\n  key: 0\n};\nconst _hoisted_3 = {\n  key: 1\n};\nconst _hoisted_4 = {\n  key: 0,\n  style: {\n    \"color\": \"red\"\n  }\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_descriptions_item = _resolveComponent(\"el-descriptions-item\");\n  const _component_el_descriptions = _resolveComponent(\"el-descriptions\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_el_button, {\n    type: \"text\",\n    onClick: _cache[0] || (_cache[0] = $event => _ctx.$router.go(-1))\n  }, {\n    default: _withCtx(() => _cache[3] || (_cache[3] = [_createTextVNode(\"返回\")])),\n    _: 1 /* STABLE */\n  }), _cache[4] || (_cache[4] = _createElementVNode(\"h1\", null, \"申诉详情\", -1 /* HOISTED */)), _createVNode(_component_el_descriptions, {\n    column: 1,\n    border: \"\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_descriptions_item, {\n      label: \"申诉单号\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($data.appeal.appealOrder), 1 /* TEXT */)]),\n\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_descriptions_item, {\n      label: \"患者姓名\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($data.appeal.patientName), 1 /* TEXT */)]),\n\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_descriptions_item, {\n      label: \"患者电话\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($options.formatPhone($data.appeal.patientPhone)), 1 /* TEXT */)]),\n\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_descriptions_item, {\n      label: \"患者性别\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($data.appeal.patientGender), 1 /* TEXT */)]),\n\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_descriptions_item, {\n      label: \"医院\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($data.appeal.hospital), 1 /* TEXT */)]),\n\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_descriptions_item, {\n      label: \"部门\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($data.appeal.department), 1 /* TEXT */)]),\n\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_descriptions_item, {\n      label: \"医生\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($data.appeal.doctor), 1 /* TEXT */)]),\n\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_descriptions_item, {\n      label: \"附件\"\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"span\", {\n        onClick: _cache[1] || (_cache[1] = $event => $options.viewAttachment($data.appeal.file)),\n        style: {\n          \"color\": \"blue\",\n          \"cursor\": \"pointer\"\n        }\n      }, _toDisplayString($data.appeal.file), 1 /* TEXT */)]),\n\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_descriptions_item, {\n      label: \"申诉内容\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($data.appeal.appealContent), 1 /* TEXT */)]),\n\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_descriptions_item, {\n      label: \"申诉时间\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($data.appeal.appealTime), 1 /* TEXT */)]),\n\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_descriptions_item, {\n      label: \"状态\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($options.formatStatus($data.appeal.status)), 1 /* TEXT */)]),\n\n      _: 1 /* STABLE */\n    })]),\n\n    _: 1 /* STABLE */\n  }), _createCommentVNode(\" 根据状态动态显示按钮文本 \"), _createVNode(_component_el_button, {\n    type: \"primary\",\n    onClick: _cache[2] || (_cache[2] = $event => $data.appeal.status === 0 ? $options.handleAppeal() : _ctx.$router.go(-1))\n  }, {\n    default: _withCtx(() => [$data.appeal.status === 0 ? (_openBlock(), _createElementBlock(\"span\", _hoisted_2, \"处理申诉\")) : $data.appeal.status === 1 ? (_openBlock(), _createElementBlock(\"span\", _hoisted_3, \"提交\")) : _createCommentVNode(\"v-if\", true)]),\n    _: 1 /* STABLE */\n  }), $data.error ? (_openBlock(), _createElementBlock(\"p\", _hoisted_4, _toDisplayString($data.error), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","style","_createElementBlock","_hoisted_1","_createVNode","_component_el_button","type","onClick","_cache","$event","_ctx","$router","go","_createElementVNode","_component_el_descriptions","column","border","_component_el_descriptions_item","label","$data","appeal","appealOrder","patientName","$options","formatPhone","patientPhone","patientGender","hospital","department","doctor","viewAttachment","file","appealContent","appealTime","formatStatus","status","_createCommentVNode","handleAppeal","_hoisted_2","_hoisted_3","error","_hoisted_4","_toDisplayString"],"sources":["E:\\专业设计项目\\HRS\\HRS-7\\vue\\src\\views\\hospitalAdmin\\AppealDetail.vue"],"sourcesContent":["<template>\r\n  <div class=\"appeal-detail\">\r\n    <el-button type=\"text\" @click=\"$router.go(-1)\">返回</el-button>\r\n    <h1>申诉详情</h1>\r\n    <el-descriptions :column=\"1\" border>\r\n      <el-descriptions-item label=\"申诉单号\">{{ appeal.appealOrder }}</el-descriptions-item>\r\n      <el-descriptions-item label=\"患者姓名\">{{ appeal.patientName }}</el-descriptions-item>\r\n      <el-descriptions-item label=\"患者电话\">{{ formatPhone(appeal.patientPhone) }}</el-descriptions-item>\r\n      <el-descriptions-item label=\"患者性别\">{{ appeal.patientGender }}</el-descriptions-item>\r\n      <el-descriptions-item label=\"医院\">{{ appeal.hospital }}</el-descriptions-item>\r\n      <el-descriptions-item label=\"部门\">{{ appeal.department }}</el-descriptions-item>\r\n      <el-descriptions-item label=\"医生\">{{ appeal.doctor }}</el-descriptions-item>\r\n      <el-descriptions-item label=\"附件\">\r\n        <span @click=\"viewAttachment(appeal.file)\" style=\"color: blue; cursor: pointer;\">\r\n          {{ appeal.file }}\r\n        </span>\r\n      </el-descriptions-item>\r\n      <el-descriptions-item label=\"申诉内容\">{{ appeal.appealContent }}</el-descriptions-item>\r\n      <el-descriptions-item label=\"申诉时间\">{{ appeal.appealTime }}</el-descriptions-item>\r\n      <el-descriptions-item label=\"状态\">{{ formatStatus(appeal.status) }}</el-descriptions-item>\r\n\r\n    </el-descriptions>\r\n    <!-- 根据状态动态显示按钮文本 -->\r\n    <el-button type=\"primary\" @click=\"appeal.status === 0 ? handleAppeal() : $router.go(-1)\">\r\n      <span v-if=\"appeal.status === 0\">处理申诉</span>\r\n      <span v-else-if=\"appeal.status === 1\">提交</span>\r\n    </el-button>\r\n    <p v-if=\"error\" style=\"color: red;\">{{ error }}</p>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nexport default {\r\n  name: 'AppealDetail',\r\n  data() {\r\n    return {\r\n      user: JSON.parse(localStorage.getItem(\"xm-user\") || '{}'),\r\n      appeal: {},\r\n      appealOrder: this.$route.params.appealOrder,\r\n      error: null,\r\n      loading: true\r\n    };\r\n  },\r\n  created() {\r\n    this.fetchAppealDetail();\r\n  },\r\n  methods: {\r\n    fetchAppealDetail() {\r\n      this.$request.get('/registration/selectByAppealOrder', {\r\n        params: {\r\n          appealOrder: this.appealOrder,\r\n        },\r\n      }).then(response => {\r\n        if (response.code == 200) {\r\n          this.appeal = response.data;\r\n        } else {\r\n          this.error = response.data.message || '获取申诉失败';\r\n        }\r\n      })\r\n          .catch(error => {\r\n            console.error('获取申诉失败:', error);\r\n            this.error = '获取申诉失败，请稍后重试';\r\n          })\r\n          .finally(() => {\r\n            this.loading = false;\r\n          });\r\n    },\r\n    formatStatus(status) {\r\n      switch (status) {\r\n        case 0:\r\n          return '待处理';\r\n        case 1:\r\n          return '处理完成';\r\n        case 2:\r\n          return '已取消';\r\n        default:\r\n          return '未知状态';\r\n      }\r\n    },\r\n    formatPhone(phone) {\r\n      if (phone && phone.length === 11) {\r\n        return phone.substring(0, 3) + '****' + phone.substring(7);\r\n      }\r\n      return phone;\r\n    },\r\n    handleAppeal() {\r\n      console.log('开始处理申诉，申诉单号：', this.appeal.appealOrder);\r\n      this.$request.post(`/registration/handleAppeal/${this.appeal.appealOrder}`).then(response => {\r\n        if (response.code == 200) {\r\n          console.log('申诉处理成功');\r\n          this.appeal.status = 1; // 假设处理中状态码为 1\r\n        } else {\r\n          this.error = response.data.message || '处理申诉失败';\r\n        }\r\n      }).catch(error => {\r\n        console.error('处理申诉失败:', error);\r\n        this.error = '处理申诉失败，请稍后重试';\r\n      });\r\n    },\r\n    viewAttachment(file) {\r\n      if (file) {\r\n        window.open(this.$baseUrl + '/files/preview/' + file)\r\n      } else {\r\n        console.log('没有附件文件');\r\n      }\r\n    },\r\n\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.appeal-detail {\r\n  padding: 20px;\r\n}\r\n\r\n.el-descriptions {\r\n  margin-top: 20px;\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}