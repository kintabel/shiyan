{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = {\n  class: \"purchase-page\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"message\"\n};\nconst _hoisted_3 = {\n  key: 1\n};\nconst _hoisted_4 = {\n  class: \"supply-table\"\n};\nconst _hoisted_5 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[5] || (_cache[5] = _createElementVNode(\"h2\", {\n    class: \"page-title\"\n  }, \"进货管理\", -1 /* HOISTED */)), _createVNode(_component_el_form, {\n    model: $data.purchaseForm,\n    rules: $data.purchaseRules,\n    ref: \"purchaseFormRef\",\n    \"label-width\": \"120px\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_form_item, {\n      label: \"物品名称\"\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"span\", null, _toDisplayString($data.purchaseForm.name), 1 /* TEXT */)]),\n\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_form_item, {\n      label: \"进货数量\",\n      prop: \"quantity\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_input, {\n        modelValue: $data.purchaseForm.quantity,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.purchaseForm.quantity = $event),\n        modelModifiers: {\n          number: true\n        },\n        placeholder: \"请输入进货数量\",\n        type: \"number\"\n      }, null, 8 /* PROPS */, [\"modelValue\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_form_item, null, {\n      default: _withCtx(() => [_createVNode(_component_el_button, {\n        type: \"primary\",\n        onClick: $options.submitPurchase\n      }, {\n        default: _withCtx(() => _cache[1] || (_cache[1] = [_createTextVNode(\"提交进货\")])),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"onClick\"]), _createVNode(_component_el_button, {\n        onClick: $options.resetForm\n      }, {\n        default: _withCtx(() => _cache[2] || (_cache[2] = [_createTextVNode(\"重置\")])),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"onClick\"])]),\n      _: 1 /* STABLE */\n    })]),\n\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"model\", \"rules\"]), $data.message ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, _toDisplayString($data.message), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), $data.supplyList.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_cache[4] || (_cache[4] = _createElementVNode(\"h3\", null, \"供应商列表\", -1 /* HOISTED */)), _createElementVNode(\"table\", _hoisted_4, [_cache[3] || (_cache[3] = _createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [_createElementVNode(\"th\", null, \"名称\"), _createElementVNode(\"th\", null, \"价格\"), _createElementVNode(\"th\", null, \"电话\"), _createElementVNode(\"th\", null, \"地址\"), _createElementVNode(\"th\", null, \"负责人\")])], -1 /* HOISTED */)), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.supplyList, (supply, index) => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: index,\n      onClick: $event => $options.selectSupplier(supply)\n    }, [_createElementVNode(\"td\", null, _toDisplayString(supply.name), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(supply.price), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(supply.phone), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(supply.address), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(supply.leader), 1 /* TEXT */)], 8 /* PROPS */, _hoisted_5);\n  }), 128 /* KEYED_FRAGMENT */))])])])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_createVNode","_component_el_form","model","$data","purchaseForm","rules","purchaseRules","ref","_component_el_form_item","label","_toDisplayString","name","prop","_component_el_input","quantity","$event","number","placeholder","type","_component_el_button","onClick","$options","submitPurchase","_cache","resetForm","message","_hoisted_2","supplyList","length","_hoisted_3","_hoisted_4","_Fragment","_renderList","supply","index","key","selectSupplier","price","phone","address","leader"],"sources":["E:\\专业设计项目\\HRS\\HRS-7\\vue\\src\\views\\hospitalAdmin\\Purchase.vue"],"sourcesContent":["<template>\r\n  <div class=\"purchase-page\">\r\n    <h2 class=\"page-title\">进货管理</h2>\r\n    <el-form :model=\"purchaseForm\" :rules=\"purchaseRules\" ref=\"purchaseFormRef\" label-width=\"120px\">\r\n      <el-form-item label=\"物品名称\">\r\n        <span>{{ purchaseForm.name }}</span>\r\n      </el-form-item>\r\n      <el-form-item label=\"进货数量\" prop=\"quantity\">\r\n        <el-input v-model.number=\"purchaseForm.quantity\" placeholder=\"请输入进货数量\" type=\"number\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"submitPurchase\">提交进货</el-button>\r\n        <el-button @click=\"resetForm\">重置</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n    <div v-if=\"message\" class=\"message\">{{ message }}</div>\r\n    <div v-if=\"supplyList.length > 0\">\r\n      <h3>供应商列表</h3>\r\n      <table class=\"supply-table\">\r\n        <thead>\r\n        <tr>\r\n          <th>名称</th>\r\n          <th>价格</th>\r\n          <th>电话</th>\r\n          <th>地址</th>\r\n          <th>负责人</th>\r\n        </tr>\r\n        </thead>\r\n        <tbody>\r\n        <tr v-for=\"(supply, index) in supplyList\" :key=\"index\" @click=\"selectSupplier(supply)\">\r\n          <td>{{ supply.name }}</td>\r\n          <td>{{ supply.price }}</td>\r\n          <td>{{ supply.phone }}</td>\r\n          <td>{{ supply.address }}</td>\r\n          <td>{{ supply.leader }}</td>\r\n        </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"Purchase\",\r\n  data() {\r\n    return {\r\n      purchaseForm: {\r\n        name: \"\",\r\n        quantity: 0,\r\n        supplierName: null,\r\n        supplierPrice: null,\r\n        supplierPhone: null,\r\n        supplierAddress: null,\r\n        supplierLeader: null,\r\n        hospitalAdminId: this.$route.query.hospitalAdminId || null,\r\n        department: this.$route.query.department || null\r\n      },\r\n      purchaseRules: {\r\n        quantity: [\r\n          { required: true, message: \"请输入进货数量\", trigger: \"blur\" },\r\n          { type: \"number\", min: 1, message: \"进货数量必须为正整数\", trigger: \"blur\" }\r\n        ]\r\n      },\r\n      message: \"\",\r\n      supplyList: [],\r\n      selectedSupplier: null\r\n    };\r\n  },\r\n  created() {\r\n    const name = this.$route.query.name;\r\n    this.purchaseForm.name = name;\r\n    this.fetchSupplyDetail(name);\r\n  },\r\n  methods: {\r\n    fetchSupplyDetail(name) {\r\n      this.$request.get(\"/stock/selectSupplier\", {\r\n        params: {\r\n          name: name\r\n        }\r\n      }).then(response => {\r\n        if (response.code == 200) {\r\n          this.supplyList = response.data;\r\n          console.log(this.supplyList);\r\n        } else {\r\n          this.error = response.data.message || \"获取数据失败\";\r\n        }\r\n      })\r\n          .catch(error => {\r\n            console.error(\"获取数据失败:\", error);\r\n            this.error = \"获取数据失败，请稍后重试\";\r\n          })\r\n          .finally(() => {\r\n            this.loading = false;\r\n          });\r\n    },\r\n\r\n    selectSupplier(supply) {\r\n      this.selectedSupplier = supply;\r\n      this.purchaseForm.supplierName = supply.name;\r\n      this.purchaseForm.supplierPrice = supply.price;\r\n      this.purchaseForm.supplierPhone = supply.phone;\r\n      this.purchaseForm.supplierAddress = supply.address;\r\n      this.purchaseForm.supplierLeader = supply.leader;\r\n      console.log(this.selectedSupplier);\r\n    },\r\n\r\n    submitPurchase() {\r\n      this.$refs.purchaseFormRef.validate((valid) => {\r\n        if (valid && this.selectedSupplier) {\r\n          const formData = {\r\n            ...this.purchaseForm,\r\n          };\r\n          console.log(formData);\r\n          this.$request.post(\"/stock/purchase\", formData).then(response => {\r\n            if (response.code == 200) {\r\n              this.message = \"进货成功\";\r\n              // 清空表单数据\r\n              this.purchaseForm.name = \"\";\r\n              this.purchaseForm.quantity = 0;\r\n              this.purchaseForm.supplierName = null;\r\n              this.purchaseForm.supplierPrice = null;\r\n              this.purchaseForm.supplierPhone = null;\r\n              this.purchaseForm.supplierAddress = null;\r\n              this.purchaseForm.supplierLeader = null;\r\n              this.selectedSupplier = null;\r\n            } else {\r\n              this.message = \"进货失败：\" + response.data.message;\r\n            }\r\n          }).catch(error => {\r\n            console.error(\"进货请求失败:\", error);\r\n            this.message = \"进货请求失败，请稍后重试\";\r\n          });\r\n        } else if (!this.selectedSupplier) {\r\n          this.message = \"请先选择一个供应商\";\r\n        }\r\n      });\r\n    },\r\n\r\n    resetForm() {\r\n      this.$refs.purchaseFormRef.resetFields();\r\n      this.message = \"\";\r\n      this.purchaseForm.supplierId = null;\r\n      this.purchaseForm.supplierName = null;\r\n      this.purchaseForm.supplierPrice = null;\r\n      this.purchaseForm.supplierPhone = null;\r\n      this.purchaseForm.supplierAddress = null;\r\n      this.purchaseForm.supplierLeader = null;\r\n      this.selectedSupplier = null;\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.purchase-page {\r\n  padding: 20px;\r\n  font-family: Arial, sans-serif;\r\n}\r\n\r\n.page-title {\r\n  margin-bottom: 20px;\r\n  font-size: 24px;\r\n  font-weight: bold;\r\n}\r\n\r\n.message {\r\n  margin-top: 10px;\r\n  color: green;\r\n}\r\n\r\n.supply-table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  margin-top: 10px;\r\n}\r\n\r\n.supply-table th,\r\n.supply-table td {\r\n  padding: 10px;\r\n  border: 1px solid #ddd;\r\n  text-align: left;\r\n}\r\n\r\n.supply-table th {\r\n  background-color: #f2f2f2;\r\n  font-weight: bold;\r\n}\r\n\r\n.supply-table tr:nth-child(even) {\r\n  background-color: #f9f9f9;\r\n}\r\n\r\n.supply-table tr:hover {\r\n  background-color: #f1f1f1;\r\n}\r\n</style>"],"mappings":";;EACOA,KAAK,EAAC;AAAe;;;EAcJA,KAAK,EAAC;;;;;;EAGjBA,KAAK,EAAC;AAAc;;;;;;;uBAjB/BC,mBAAA,CAsCM,OAtCNC,UAsCM,G,0BArCJC,mBAAA,CAAgC;IAA5BH,KAAK,EAAC;EAAY,GAAC,MAAI,sBAC3BI,YAAA,CAWUC,kBAAA;IAXAC,KAAK,EAAEC,KAAA,CAAAC,YAAY;IAAGC,KAAK,EAAEF,KAAA,CAAAG,aAAa;IAAEC,GAAG,EAAC,iBAAiB;IAAC,aAAW,EAAC;;sBACtF,MAEe,CAFfP,YAAA,CAEeQ,uBAAA;MAFDC,KAAK,EAAC;IAAM;wBACxB,MAAoC,CAApCV,mBAAA,CAAoC,cAAAW,gBAAA,CAA3BP,KAAA,CAAAC,YAAY,CAACO,IAAI,iB;;;QAE5BX,YAAA,CAEeQ,uBAAA;MAFDC,KAAK,EAAC,MAAM;MAACG,IAAI,EAAC;;wBAC9B,MAAgG,CAAhGZ,YAAA,CAAgGa,mBAAA;oBAAtEV,KAAA,CAAAC,YAAY,CAACU,QAAQ;mEAArBX,KAAA,CAAAC,YAAY,CAACU,QAAQ,GAAAC,MAAA;wBAArC;UAAAC,MAAA;QAAA,CAAsC;QAACC,WAAW,EAAC,SAAS;QAACC,IAAI,EAAC;;;QAE9ElB,YAAA,CAGeQ,uBAAA;wBAFb,MAAkE,CAAlER,YAAA,CAAkEmB,oBAAA;QAAvDD,IAAI,EAAC,SAAS;QAAEE,OAAK,EAAEC,QAAA,CAAAC;;0BAAgB,MAAIC,MAAA,QAAAA,MAAA,O,iBAAJ,MAAI,E;;sCACtDvB,YAAA,CAA4CmB,oBAAA;QAAhCC,OAAK,EAAEC,QAAA,CAAAG;MAAS;0BAAE,MAAED,MAAA,QAAAA,MAAA,O,iBAAF,IAAE,E;;;;;;;yCAGzBpB,KAAA,CAAAsB,OAAO,I,cAAlB5B,mBAAA,CAAuD,OAAvD6B,UAAuD,EAAAhB,gBAAA,CAAhBP,KAAA,CAAAsB,OAAO,oB,mCACnCtB,KAAA,CAAAwB,UAAU,CAACC,MAAM,Q,cAA5B/B,mBAAA,CAsBM,OAAAgC,UAAA,G,0BArBJ9B,mBAAA,CAAc,YAAV,OAAK,sBACTA,mBAAA,CAmBQ,SAnBR+B,UAmBQ,G,0BAlBN/B,mBAAA,CAQQ,gBAPRA,mBAAA,CAMK,aALHA,mBAAA,CAAW,YAAP,IAAE,GACNA,mBAAA,CAAW,YAAP,IAAE,GACNA,mBAAA,CAAW,YAAP,IAAE,GACNA,mBAAA,CAAW,YAAP,IAAE,GACNA,mBAAA,CAAY,YAAR,KAAG,E,wBAGTA,mBAAA,CAQQ,iB,kBAPRF,mBAAA,CAMKkC,SAAA,QAAAC,WAAA,CANyB7B,KAAA,CAAAwB,UAAU,GAA5BM,MAAM,EAAEC,KAAK;yBAAzBrC,mBAAA,CAMK;MANsCsC,GAAG,EAAED,KAAK;MAAGd,OAAK,EAAAL,MAAA,IAAEM,QAAA,CAAAe,cAAc,CAACH,MAAM;QAClFlC,mBAAA,CAA0B,YAAAW,gBAAA,CAAnBuB,MAAM,CAACtB,IAAI,kBAClBZ,mBAAA,CAA2B,YAAAW,gBAAA,CAApBuB,MAAM,CAACI,KAAK,kBACnBtC,mBAAA,CAA2B,YAAAW,gBAAA,CAApBuB,MAAM,CAACK,KAAK,kBACnBvC,mBAAA,CAA6B,YAAAW,gBAAA,CAAtBuB,MAAM,CAACM,OAAO,kBACrBxC,mBAAA,CAA4B,YAAAW,gBAAA,CAArBuB,MAAM,CAACO,MAAM,iB"},"metadata":{},"sourceType":"module","externalDependencies":[]}