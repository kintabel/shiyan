{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx } from \"vue\";\nconst _hoisted_1 = {\n  class: \"appointment-page\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"loading-container\"\n};\nconst _hoisted_3 = {\n  key: 1\n};\nconst _hoisted_4 = {\n  class: \"header-info\"\n};\nconst _hoisted_5 = {\n  class: \"date-selection\"\n};\nconst _hoisted_6 = {\n  key: 0,\n  class: \"action-buttons\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_spinner = _resolveComponent(\"el-spinner\");\n  const _component_el_date_picker = _resolveComponent(\"el-date-picker\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" 数据加载中提示 \"), $data.isLoading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createVNode(_component_el_spinner), _cache[1] || (_cache[1] = _createElementVNode(\"span\", null, \"正在加载数据...\", -1 /* HOISTED */))])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createCommentVNode(\" 医院和科室信息展示 \"), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"h2\", null, _toDisplayString($data.hospitalName) + \" - \" + _toDisplayString($data.departmentName), 1 /* TEXT */), _cache[2] || (_cache[2] = _createElementVNode(\"p\", null, \"请选择预约日期\", -1 /* HOISTED */))]), _createCommentVNode(\" 日期选择 \"), _createElementVNode(\"div\", _hoisted_5, [_createVNode(_component_el_date_picker, {\n    modelValue: $data.selectedDate,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.selectedDate = $event),\n    type: \"date\",\n    placeholder: \"选择预约日期\",\n    \"picker-options\": $data.pickerOptions,\n    \"disabled-date\": $options.disabledDate,\n    onChange: $options.handleDateChange\n  }, null, 8 /* PROPS */, [\"modelValue\", \"picker-options\", \"disabled-date\", \"onChange\"])]), _createCommentVNode(\" 操作按钮 \"), $data.selectedDate ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createVNode(_component_el_button, {\n    type: \"primary\",\n    onClick: $options.goToDoctorSchedule,\n    disabled: !$data.selectedDate\n  }, {\n    default: _withCtx(() => _cache[3] || (_cache[3] = [_createTextVNode(\" 查看当天排班医生 \")])),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\", \"disabled\"])])) : _createCommentVNode(\"v-if\", true)]))]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createCommentVNode","$data","isLoading","_hoisted_2","_createVNode","_component_el_spinner","_createElementVNode","_hoisted_3","_hoisted_4","_toDisplayString","hospitalName","departmentName","_hoisted_5","_component_el_date_picker","selectedDate","$event","type","placeholder","pickerOptions","$options","disabledDate","onChange","handleDateChange","_hoisted_6","_component_el_button","onClick","goToDoctorSchedule","disabled","_cache"],"sources":["E:\\专业设计项目\\HRS\\HRS-7\\vue\\src\\views\\user\\AppointmentRegister.vue"],"sourcesContent":["<template>\r\n  <div class=\"appointment-page\">\r\n    <!-- 数据加载中提示 -->\r\n    <div v-if=\"isLoading\" class=\"loading-container\">\r\n      <el-spinner />\r\n      <span>正在加载数据...</span>\r\n    </div>\r\n\r\n    <div v-else>\r\n      <!-- 医院和科室信息展示 -->\r\n      <div class=\"header-info\">\r\n        <h2>{{ hospitalName }} - {{ departmentName }}</h2>\r\n        <p>请选择预约日期</p>\r\n      </div>\r\n\r\n      <!-- 日期选择 -->\r\n      <div class=\"date-selection\">\r\n        <el-date-picker\r\n            v-model=\"selectedDate\"\r\n            type=\"date\"\r\n            placeholder=\"选择预约日期\"\r\n            :picker-options=\"pickerOptions\"\r\n            :disabled-date=\"disabledDate\"\r\n            @change=\"handleDateChange\"\r\n        />\r\n      </div>\r\n\r\n      <!-- 操作按钮 -->\r\n      <div class=\"action-buttons\" v-if=\"selectedDate\">\r\n        <el-button\r\n            type=\"primary\"\r\n            @click=\"goToDoctorSchedule\"\r\n            :disabled=\"!selectedDate\"\r\n        >\r\n          查看当天排班医生\r\n        </el-button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { parseTime } from '@/utils'\r\n\r\nexport default {\r\n  name: 'AppointmentRegister',\r\n  data() {\r\n    return {\r\n      isLoading: false,\r\n      hospitalId: this.$route.params.hospitalId,\r\n      departmentId: this.$route.params.departmentId,\r\n      hospitalName: '',\r\n      departmentName: '',\r\n      selectedDate: new Date(), // 默认今天\r\n      pickerOptions: {\r\n        shortcuts: [{\r\n          text: '今天',\r\n          onClick(picker) {\r\n            picker.$emit('pick', new Date())\r\n          }\r\n        }, {\r\n          text: '明天',\r\n          onClick(picker) {\r\n            const date = new Date()\r\n            date.setDate(date.getDate() + 1)\r\n            picker.$emit('pick', date)\r\n          }\r\n        }, {\r\n          text: '一周后',\r\n          onClick(picker) {\r\n            const date = new Date()\r\n            date.setDate(date.getDate() + 7)\r\n            picker.$emit('pick', date)\r\n          }\r\n        }]\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.fetchHospitalAndDepartmentInfo()\r\n  },\r\n  methods: {\r\n    // 获取医院和科室信息\r\n    async fetchHospitalAndDepartmentInfo() {\r\n      try {\r\n        this.isLoading = true\r\n\r\n        // 获取医院信息\r\n        const hospitalRes = await this.$request.get(`/hospital/selectById/${this.hospitalId}`)\r\n        if (hospitalRes.data) {\r\n          this.hospitalName = hospitalRes.data\r\n          console.log(hospitalRes.data)\r\n        }\r\n\r\n        // 获取科室信息\r\n        const deptRes = await this.$request.get(`/hospital/selectDepById/${this.departmentId}`)\r\n        if (deptRes.data) {\r\n          this.departmentName = deptRes.data\r\n        }\r\n      } catch (error) {\r\n        console.error('获取医院或科室信息失败:', error)\r\n        this.$message.error('获取信息失败，请稍后重试')\r\n      } finally {\r\n        this.isLoading = false\r\n      }\r\n    },\r\n\r\n    // 禁用过去的日期\r\n    disabledDate(time) {\r\n      return time.getTime() < Date.now() - 24 * 60 * 60 * 1000\r\n    },\r\n\r\n    // 日期变化处理\r\n    handleDateChange() {\r\n    },\r\n\r\n    // 跳转到医生排班界面\r\n    goToDoctorSchedule() {\r\n      if (!this.selectedDate) {\r\n        this.$message.warning('请先选择预约日期')\r\n        return\r\n      }\r\n\r\n      const formattedDate = parseTime(this.selectedDate, '{y}-{m}-{d}')\r\n\r\n      this.$router.push({\r\n        name: 'Doctor',\r\n        params: {\r\n          hospitalId: this.hospitalId,\r\n          departmentId: this.departmentId,\r\n          isAppointment: true,\r\n        },\r\n        query: {\r\n          scheduleDate: formattedDate\r\n        }\r\n      })\r\n    },\r\n\r\n    // 格式化日期显示\r\n    formatDate(date) {\r\n      return parseTime(date, '{y}年{m}月{d}日')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.appointment-page {\r\n  padding: 20px;\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.loading-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 50px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.header-info {\r\n  margin-bottom: 30px;\r\n  text-align: center;\r\n}\r\n\r\n.header-info h2 {\r\n  margin-bottom: 10px;\r\n  color: #333;\r\n}\r\n\r\n.date-selection {\r\n  display: flex;\r\n  justify-content: center;\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.action-buttons {\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n\r\n.el-date-editor {\r\n  width: 300px;\r\n}\r\n</style>"],"mappings":";;EACOA,KAAK,EAAC;AAAkB;;;EAELA,KAAK,EAAC;;;;;;EAOrBA,KAAK,EAAC;AAAa;;EAMnBA,KAAK,EAAC;AAAgB;;;EAYtBA,KAAK,EAAC;;;;;;uBA3BfC,mBAAA,CAqCM,OArCNC,UAqCM,GApCJC,mBAAA,aAAgB,EACLC,KAAA,CAAAC,SAAS,I,cAApBJ,mBAAA,CAGM,OAHNK,UAGM,GAFJC,YAAA,CAAcC,qBAAA,G,0BACdC,mBAAA,CAAsB,cAAhB,WAAS,qB,oBAGjBR,mBAAA,CA6BM,OAAAS,UAAA,GA5BJP,mBAAA,eAAkB,EAClBM,mBAAA,CAGM,OAHNE,UAGM,GAFJF,mBAAA,CAAkD,YAAAG,gBAAA,CAA3CR,KAAA,CAAAS,YAAY,IAAG,KAAG,GAAAD,gBAAA,CAAGR,KAAA,CAAAU,cAAc,kB,0BAC1CL,mBAAA,CAAc,WAAX,SAAO,qB,GAGZN,mBAAA,UAAa,EACbM,mBAAA,CASM,OATNM,UASM,GARJR,YAAA,CAOES,yBAAA;gBANWZ,KAAA,CAAAa,YAAY;+DAAZb,KAAA,CAAAa,YAAY,GAAAC,MAAA;IACrBC,IAAI,EAAC,MAAM;IACXC,WAAW,EAAC,QAAQ;IACnB,gBAAc,EAAEhB,KAAA,CAAAiB,aAAa;IAC7B,eAAa,EAAEC,QAAA,CAAAC,YAAY;IAC3BC,QAAM,EAAEF,QAAA,CAAAG;4FAIftB,mBAAA,UAAa,EACqBC,KAAA,CAAAa,YAAY,I,cAA9ChB,mBAAA,CAQM,OARNyB,UAQM,GAPJnB,YAAA,CAMYoB,oBAAA;IALRR,IAAI,EAAC,SAAS;IACbS,OAAK,EAAEN,QAAA,CAAAO,kBAAkB;IACzBC,QAAQ,GAAG1B,KAAA,CAAAa;;sBACf,MAEDc,MAAA,QAAAA,MAAA,O,iBAFC,YAED,E"},"metadata":{},"sourceType":"module","externalDependencies":[]}