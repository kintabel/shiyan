{"ast":null,"code":"export default {\n  name: 'OperationLog',\n  data() {\n    return {\n      // 查询参数\n      queryParams: {\n        pageNum: 1,\n        pageSize: 10,\n        module: '',\n        userName: ''\n      },\n      loading: false,\n      logList: [],\n      total: 0,\n      detailVisible: false,\n      currentLog: {}\n    };\n  },\n  methods: {\n    // 获取日志列表\n    getList() {\n      this.loading = true;\n      this.$request.get('/admin/selectAllOperationLog', {\n        params: this.queryParams\n      }).then(response => {\n        this.logList = response.data.list;\n        this.total = response.data.total;\n      }).finally(() => {\n        this.loading = false;\n      });\n    },\n    // 查询操作\n    handleQuery() {\n      this.queryParams.pageNum = 1;\n      this.getList();\n    },\n    // 重置查询\n    resetQuery() {\n      this.queryParams = {\n        pageNum: 1,\n        pageSize: 10,\n        module: '',\n        userName: ''\n      };\n      this.getList();\n    },\n    // 分页大小变化\n    handleSizeChange(val) {\n      this.queryParams.pageSize = val;\n      this.getList();\n    },\n    // 当前页变化\n    handleCurrentChange(val) {\n      this.queryParams.pageNum = val;\n      this.getList();\n    },\n    // 显示详情\n    showDetail(row) {\n      this.currentLog = row;\n      this.detailVisible = true;\n    },\n    // 格式化参数\n    formatParams(params) {\n      try {\n        const obj = JSON.parse(params);\n        return JSON.stringify(obj, null, 2);\n      } catch (e) {\n        return params;\n      }\n    }\n  },\n  mounted() {\n    this.getList();\n  }\n};","map":{"version":3,"names":["name","data","queryParams","pageNum","pageSize","module","userName","loading","logList","total","detailVisible","currentLog","methods","getList","$request","get","params","then","response","list","finally","handleQuery","resetQuery","handleSizeChange","val","handleCurrentChange","showDetail","row","formatParams","obj","JSON","parse","stringify","e","mounted"],"sources":["src/views/topAdmin/OperationLog.vue"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <el-card>\r\n      <div slot=\"header\" class=\"clearfix\">\r\n        <span>操作日志追踪</span>\r\n      </div>\r\n\r\n      <!-- 查询表单 -->\r\n      <el-form :inline=\"true\" :model=\"queryParams\" class=\"search-form\">\r\n        <el-form-item label=\"操作模块\">\r\n          <el-input\r\n              v-model=\"queryParams.module\"\r\n              placeholder=\"请输入模块名称\"\r\n              clearable\r\n          ></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"操作人员\">\r\n          <el-input\r\n              v-model=\"queryParams.userName\"\r\n              placeholder=\"请输入操作人员\"\r\n              clearable\r\n          ></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"handleQuery\">查询</el-button>\r\n          <el-button @click=\"resetQuery\">重置</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n\r\n      <!-- 日志表格 -->\r\n      <el-table\r\n          :data=\"logList\"\r\n          border\r\n          style=\"width: 100%\"\r\n          v-loading=\"loading\"\r\n      >\r\n        <el-table-column prop=\"module\" label=\"操作模块\" width=\"120\"></el-table-column>\r\n        <el-table-column prop=\"type\" label=\"操作类型\" width=\"100\"></el-table-column>\r\n        <el-table-column prop=\"userName\" label=\"操作人员\" width=\"120\"></el-table-column>\r\n        <el-table-column prop=\"description\" label=\"操作描述\"></el-table-column>\r\n        <el-table-column prop=\"method\" label=\"请求方法\" width=\"120\"></el-table-column>\r\n        <el-table-column prop=\"createTime\" label=\"操作时间\" width=\"160\"></el-table-column>\r\n        <el-table-column label=\"操作\" width=\"80\">\r\n          <template #default=\"scope\">\r\n            <el-button\r\n                size=\"mini\"\r\n                type=\"text\"\r\n                @click=\"showDetail(scope.row)\"\r\n            >详情</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      <!-- 分页 -->\r\n      <el-pagination\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n          :current-page=\"queryParams.pageNum\"\r\n          :page-sizes=\"[10, 20, 30, 50]\"\r\n          :page-size=\"queryParams.pageSize\"\r\n          layout=\"total, sizes, prev, pager, next\"\r\n          :total=\"total\"\r\n          style=\"margin-top: 20px\"\r\n      ></el-pagination>\r\n\r\n      <!-- 日志详情对话框 -->\r\n      <el-dialog title=\"操作日志详情\" :visible.sync=\"detailVisible\" width=\"50%\">\r\n        <el-descriptions :column=\"1\" border>\r\n          <el-descriptions-item label=\"操作模块\">{{ currentLog.module }}</el-descriptions-item>\r\n          <el-descriptions-item label=\"操作类型\">{{ currentLog.type }}</el-descriptions-item>\r\n          <el-descriptions-item label=\"操作人员\">{{ currentLog.userName }}</el-descriptions-item>\r\n          <el-descriptions-item label=\"请求方法\">{{ currentLog.method }}</el-descriptions-item>\r\n          <el-descriptions-item label=\"操作时间\">{{ currentLog.createTime }}</el-descriptions-item>\r\n          <el-descriptions-item label=\"操作描述\">{{ currentLog.description }}</el-descriptions-item>\r\n          <el-descriptions-item label=\"请求参数\">\r\n            <pre style=\"margin: 0\">{{ formatParams(currentLog.params) }}</pre>\r\n          </el-descriptions-item>\r\n        </el-descriptions>\r\n        <span slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"detailVisible = false\">关闭</el-button>\r\n        </span>\r\n      </el-dialog>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'OperationLog',\r\n  data() {\r\n    return {\r\n      // 查询参数\r\n      queryParams: {\r\n        pageNum: 1,\r\n        pageSize: 10,\r\n        module: '',\r\n        userName: ''\r\n      },\r\n      loading: false,\r\n      logList: [],\r\n      total: 0,\r\n      detailVisible: false,\r\n      currentLog: {}\r\n    }\r\n  },\r\n  methods: {\r\n    // 获取日志列表\r\n    getList() {\r\n      this.loading = true\r\n      this.$request.get('/admin/selectAllOperationLog', {\r\n        params: this.queryParams\r\n      }).then(response => {\r\n        this.logList = response.data.list\r\n        this.total = response.data.total\r\n      }).finally(() => {\r\n        this.loading = false\r\n      })\r\n    },\r\n\r\n    // 查询操作\r\n    handleQuery() {\r\n      this.queryParams.pageNum = 1\r\n      this.getList()\r\n    },\r\n\r\n    // 重置查询\r\n    resetQuery() {\r\n      this.queryParams = {\r\n        pageNum: 1,\r\n        pageSize: 10,\r\n        module: '',\r\n        userName: ''\r\n      }\r\n      this.getList()\r\n    },\r\n\r\n    // 分页大小变化\r\n    handleSizeChange(val) {\r\n      this.queryParams.pageSize = val\r\n      this.getList()\r\n    },\r\n\r\n    // 当前页变化\r\n    handleCurrentChange(val) {\r\n      this.queryParams.pageNum = val\r\n      this.getList()\r\n    },\r\n\r\n    // 显示详情\r\n    showDetail(row) {\r\n      this.currentLog = row\r\n      this.detailVisible = true\r\n    },\r\n\r\n    // 格式化参数\r\n    formatParams(params) {\r\n      try {\r\n        const obj = JSON.parse(params)\r\n        return JSON.stringify(obj, null, 2)\r\n      } catch (e) {\r\n        return params\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getList()\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.search-form {\r\n  margin-bottom: 20px;\r\n}\r\n</style>"],"mappings":"AAuFA;EACAA,IAAA;EACAC,KAAA;IACA;MACA;MACAC,WAAA;QACAC,OAAA;QACAC,QAAA;QACAC,MAAA;QACAC,QAAA;MACA;MACAC,OAAA;MACAC,OAAA;MACAC,KAAA;MACAC,aAAA;MACAC,UAAA;IACA;EACA;EACAC,OAAA;IACA;IACAC,QAAA;MACA,KAAAN,OAAA;MACA,KAAAO,QAAA,CAAAC,GAAA;QACAC,MAAA,OAAAd;MACA,GAAAe,IAAA,CAAAC,QAAA;QACA,KAAAV,OAAA,GAAAU,QAAA,CAAAjB,IAAA,CAAAkB,IAAA;QACA,KAAAV,KAAA,GAAAS,QAAA,CAAAjB,IAAA,CAAAQ,KAAA;MACA,GAAAW,OAAA;QACA,KAAAb,OAAA;MACA;IACA;IAEA;IACAc,YAAA;MACA,KAAAnB,WAAA,CAAAC,OAAA;MACA,KAAAU,OAAA;IACA;IAEA;IACAS,WAAA;MACA,KAAApB,WAAA;QACAC,OAAA;QACAC,QAAA;QACAC,MAAA;QACAC,QAAA;MACA;MACA,KAAAO,OAAA;IACA;IAEA;IACAU,iBAAAC,GAAA;MACA,KAAAtB,WAAA,CAAAE,QAAA,GAAAoB,GAAA;MACA,KAAAX,OAAA;IACA;IAEA;IACAY,oBAAAD,GAAA;MACA,KAAAtB,WAAA,CAAAC,OAAA,GAAAqB,GAAA;MACA,KAAAX,OAAA;IACA;IAEA;IACAa,WAAAC,GAAA;MACA,KAAAhB,UAAA,GAAAgB,GAAA;MACA,KAAAjB,aAAA;IACA;IAEA;IACAkB,aAAAZ,MAAA;MACA;QACA,MAAAa,GAAA,GAAAC,IAAA,CAAAC,KAAA,CAAAf,MAAA;QACA,OAAAc,IAAA,CAAAE,SAAA,CAAAH,GAAA;MACA,SAAAI,CAAA;QACA,OAAAjB,MAAA;MACA;IACA;EACA;EACAkB,QAAA;IACA,KAAArB,OAAA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}