{"ast":null,"code":"export default {\n  name: \"Purchase\",\n  data() {\n    return {\n      purchaseForm: {\n        name: \"\",\n        quantity: 0,\n        supplierId: null,\n        // 新增字段用于存储选择的供应商ID（假设数据中有id字段，这里先设为null）\n        supplierName: null,\n        // 新增字段用于存储选择的供应商名称\n        supplierPrice: null,\n        // 新增字段用于存储选择的供应商价格\n        supplierPhone: null,\n        // 新增字段用于存储选择的供应商电话\n        supplierAddress: null,\n        // 新增字段用于存储选择的供应商地址\n        supplierLeader: null // 新增字段用于存储选择的供应商负责人\n      },\n\n      purchaseRules: {\n        quantity: [{\n          required: true,\n          message: \"请输入进货数量\",\n          trigger: \"blur\"\n        }, {\n          type: \"number\",\n          min: 1,\n          message: \"进货数量必须为正整数\",\n          trigger: \"blur\"\n        }]\n      },\n      message: \"\",\n      supplyList: [],\n      selectedSupplier: null // 用于存储当前选择的供应商信息\n    };\n  },\n\n  created() {\n    const name = this.$route.query.name;\n    this.purchaseForm.name = name;\n    this.fetchSupplyDetail(name);\n  },\n  methods: {\n    fetchSupplyDetail(name) {\n      this.$request.get(\"/stock/selectSupplier\", {\n        params: {\n          name: name\n        }\n      }).then(response => {\n        if (response.code === 200) {\n          this.supplyList = response.data;\n          console.log(this.supplyList);\n        } else {\n          this.error = response.data.message || \"获取数据失败\";\n        }\n      }).catch(error => {\n        console.error(\"获取数据失败:\", error);\n        this.error = \"获取数据失败，请稍后重试\";\n      }).finally(() => {\n        this.loading = false;\n      });\n    },\n    selectSupplier(supply) {\n      this.selectedSupplier = supply;\n      this.purchaseForm.supplierId = supply.id; // 假设数据中有id字段\n      this.purchaseForm.supplierName = supply.name;\n      this.purchaseForm.supplierPrice = supply.price;\n      this.purchaseForm.supplierPhone = supply.phone;\n      this.purchaseForm.supplierAddress = supply.address;\n      this.purchaseForm.supplierLeader = supply.leader;\n    },\n    submitPurchase() {\n      this.$refs.purchaseFormRef.validate(valid => {\n        if (valid && this.selectedSupplier) {\n          const formData = {\n            ...this.purchaseForm\n            // 可以在这里添加更多需要提交的字段\n          };\n\n          this.$request.post(\"/stock/purchase\", formData).then(response => {\n            if (response.code === 200) {\n              this.message = \"进货成功\";\n              // 清空表单数据\n              this.purchaseForm.name = \"\";\n              this.purchaseForm.quantity = 0;\n              this.purchaseForm.supplierId = null;\n              this.purchaseForm.supplierName = null;\n              this.purchaseForm.supplierPrice = null;\n              this.purchaseForm.supplierPhone = null;\n              this.purchaseForm.supplierAddress = null;\n              this.purchaseForm.supplierLeader = null;\n              this.selectedSupplier = null;\n            } else {\n              this.message = \"进货失败：\" + response.data.message;\n            }\n          }).catch(error => {\n            console.error(\"进货请求失败:\", error);\n            this.message = \"进货请求失败，请稍后重试\";\n          });\n        } else if (!this.selectedSupplier) {\n          this.message = \"请先选择一个供应商\";\n        }\n      });\n    },\n    resetForm() {\n      this.$refs.purchaseFormRef.resetFields();\n      this.message = \"\";\n      this.purchaseForm.supplierId = null;\n      this.purchaseForm.supplierName = null;\n      this.purchaseForm.supplierPrice = null;\n      this.purchaseForm.supplierPhone = null;\n      this.purchaseForm.supplierAddress = null;\n      this.purchaseForm.supplierLeader = null;\n      this.selectedSupplier = null;\n    }\n  }\n};","map":{"version":3,"names":["name","data","purchaseForm","quantity","supplierId","supplierName","supplierPrice","supplierPhone","supplierAddress","supplierLeader","purchaseRules","required","message","trigger","type","min","supplyList","selectedSupplier","created","$route","query","fetchSupplyDetail","methods","$request","get","params","then","response","code","console","log","error","catch","finally","loading","selectSupplier","supply","id","price","phone","address","leader","submitPurchase","$refs","purchaseFormRef","validate","valid","formData","post","resetForm","resetFields"],"sources":["src/views/hospitalAdmin/purchase.vue"],"sourcesContent":["<template>\r\n  <div class=\"purchase-page\">\r\n    <h2 class=\"page-title\">进货管理</h2>\r\n    <el-form :model=\"purchaseForm\" :rules=\"purchaseRules\" ref=\"purchaseFormRef\" label-width=\"120px\">\r\n      <el-form-item label=\"物品名称\">\r\n        <span>{{ purchaseForm.name }}</span>\r\n      </el-form-item>\r\n      <el-form-item label=\"进货数量\" prop=\"quantity\">\r\n        <el-input v-model.number=\"purchaseForm.quantity\" placeholder=\"请输入进货数量\" type=\"number\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"submitPurchase\">提交进货</el-button>\r\n        <el-button @click=\"resetForm\">重置</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n    <div v-if=\"message\" class=\"message\">{{ message }}</div>\r\n    <div v-if=\"supplyList.length > 0\">\r\n      <h3>供应商列表</h3>\r\n      <table class=\"supply-table\">\r\n        <thead>\r\n        <tr>\r\n          <th>名称</th>\r\n          <th>价格</th>\r\n          <th>电话</th>\r\n          <th>地址</th>\r\n          <th>负责人</th>\r\n        </tr>\r\n        </thead>\r\n        <tbody>\r\n        <tr v-for=\"(supply, index) in supplyList\" :key=\"index\" @click=\"selectSupplier(supply)\">\r\n          <td>{{ supply.name }}</td>\r\n          <td>{{ supply.price }}</td>\r\n          <td>{{ supply.phone }}</td>\r\n          <td>{{ supply.address }}</td>\r\n          <td>{{ supply.leader }}</td>\r\n        </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"Purchase\",\r\n  data() {\r\n    return {\r\n      purchaseForm: {\r\n        name: \"\",\r\n        quantity: 0,\r\n        supplierId: null, // 新增字段用于存储选择的供应商ID（假设数据中有id字段，这里先设为null）\r\n        supplierName: null, // 新增字段用于存储选择的供应商名称\r\n        supplierPrice: null, // 新增字段用于存储选择的供应商价格\r\n        supplierPhone: null, // 新增字段用于存储选择的供应商电话\r\n        supplierAddress: null, // 新增字段用于存储选择的供应商地址\r\n        supplierLeader: null // 新增字段用于存储选择的供应商负责人\r\n      },\r\n      purchaseRules: {\r\n        quantity: [\r\n          { required: true, message: \"请输入进货数量\", trigger: \"blur\" },\r\n          { type: \"number\", min: 1, message: \"进货数量必须为正整数\", trigger: \"blur\" }\r\n        ]\r\n      },\r\n      message: \"\",\r\n      supplyList: [],\r\n      selectedSupplier: null // 用于存储当前选择的供应商信息\r\n    };\r\n  },\r\n  created() {\r\n    const name = this.$route.query.name;\r\n    this.purchaseForm.name = name;\r\n    this.fetchSupplyDetail(name);\r\n  },\r\n  methods: {\r\n    fetchSupplyDetail(name) {\r\n      this.$request.get(\"/stock/selectSupplier\", {\r\n        params: {\r\n          name: name\r\n        }\r\n      }).then(response => {\r\n        if (response.code === 200) {\r\n          this.supplyList = response.data;\r\n          console.log(this.supplyList);\r\n        } else {\r\n          this.error = response.data.message || \"获取数据失败\";\r\n        }\r\n      })\r\n          .catch(error => {\r\n            console.error(\"获取数据失败:\", error);\r\n            this.error = \"获取数据失败，请稍后重试\";\r\n          })\r\n          .finally(() => {\r\n            this.loading = false;\r\n          });\r\n    },\r\n\r\n    selectSupplier(supply) {\r\n      this.selectedSupplier = supply;\r\n      this.purchaseForm.supplierId = supply.id; // 假设数据中有id字段\r\n      this.purchaseForm.supplierName = supply.name;\r\n      this.purchaseForm.supplierPrice = supply.price;\r\n      this.purchaseForm.supplierPhone = supply.phone;\r\n      this.purchaseForm.supplierAddress = supply.address;\r\n      this.purchaseForm.supplierLeader = supply.leader;\r\n    },\r\n\r\n    submitPurchase() {\r\n      this.$refs.purchaseFormRef.validate((valid) => {\r\n        if (valid && this.selectedSupplier) {\r\n          const formData = {\r\n            ...this.purchaseForm,\r\n            // 可以在这里添加更多需要提交的字段\r\n          };\r\n          this.$request.post(\"/stock/purchase\", formData).then(response => {\r\n            if (response.code === 200) {\r\n              this.message = \"进货成功\";\r\n              // 清空表单数据\r\n              this.purchaseForm.name = \"\";\r\n              this.purchaseForm.quantity = 0;\r\n              this.purchaseForm.supplierId = null;\r\n              this.purchaseForm.supplierName = null;\r\n              this.purchaseForm.supplierPrice = null;\r\n              this.purchaseForm.supplierPhone = null;\r\n              this.purchaseForm.supplierAddress = null;\r\n              this.purchaseForm.supplierLeader = null;\r\n              this.selectedSupplier = null;\r\n            } else {\r\n              this.message = \"进货失败：\" + response.data.message;\r\n            }\r\n          }).catch(error => {\r\n            console.error(\"进货请求失败:\", error);\r\n            this.message = \"进货请求失败，请稍后重试\";\r\n          });\r\n        } else if (!this.selectedSupplier) {\r\n          this.message = \"请先选择一个供应商\";\r\n        }\r\n      });\r\n    },\r\n\r\n    resetForm() {\r\n      this.$refs.purchaseFormRef.resetFields();\r\n      this.message = \"\";\r\n      this.purchaseForm.supplierId = null;\r\n      this.purchaseForm.supplierName = null;\r\n      this.purchaseForm.supplierPrice = null;\r\n      this.purchaseForm.supplierPhone = null;\r\n      this.purchaseForm.supplierAddress = null;\r\n      this.purchaseForm.supplierLeader = null;\r\n      this.selectedSupplier = null;\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.purchase-page {\r\n  padding: 20px;\r\n  font-family: Arial, sans-serif;\r\n}\r\n\r\n.page-title {\r\n  margin-bottom: 20px;\r\n  font-size: 24px;\r\n  font-weight: bold;\r\n}\r\n\r\n.message {\r\n  margin-top: 10px;\r\n  color: green;\r\n}\r\n\r\n.supply-table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  margin-top: 10px;\r\n}\r\n\r\n.supply-table th,\r\n.supply-table td {\r\n  padding: 10px;\r\n  border: 1px solid #ddd;\r\n  text-align: left;\r\n}\r\n\r\n.supply-table th {\r\n  background-color: #f2f2f2;\r\n  font-weight: bold;\r\n}\r\n\r\n.supply-table tr:nth-child(even) {\r\n  background-color: #f9f9f9;\r\n}\r\n\r\n.supply-table tr:hover {\r\n  background-color: #f1f1f1;\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}